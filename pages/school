import streamlit as st
import pandas as pd
import altair as alt

st.set_page_config(page_title="ì§€ì—­/í•™êµë³„ ìê²©ì¦ ì·¨ë“ í˜„í™©", page_icon="ğŸ«", layout="wide")
st.title("ğŸ« ì§€ì—­ë³„Â·í•™êµë³„ ìê²©ì¦ ì·¨ë“ í˜„í™© ì§‘ê³„")
st.write("ì§€ì—­ê³¼ í•™êµë³„ë¡œ í•™ìƒë“¤ì˜ ìê²©ì¦ ì·¨ë“ í˜„í™©ì„ ì§‘ê³„í•˜ê³  ì‹œê°í™”í•©ë‹ˆë‹¤.")

# ìƒ˜í”Œ ë°ì´í„° ìƒì„± (ì‹¤ì œ ë°ì´í„° ì—°ë™ ì‹œ êµ¬ì¡° ì°¸ê³ )
data = [
	{"ì§€ì—­": "ì„œìš¸", "í•™êµ": "Aê³ ", "ìê²©ì¦ëª…": "ìë™ì°¨ì •ë¹„ê¸°ëŠ¥ì‚¬", "ì·¨ë“ì ìˆ˜": 12},
	{"ì§€ì—­": "ì„œìš¸", "í•™êµ": "Aê³ ", "ìê²©ì¦ëª…": "ìš´ì „ë©´í—ˆ(1ì¢…)", "ì·¨ë“ì ìˆ˜": 8},
	{"ì§€ì—­": "ì„œìš¸", "í•™êµ": "Bê³ ", "ìê²©ì¦ëª…": "ìë™ì°¨ì •ë¹„ê¸°ëŠ¥ì‚¬", "ì·¨ë“ì ìˆ˜": 10},
	{"ì§€ì—­": "ê²½ê¸°", "í•™êµ": "Cê³ ", "ìê²©ì¦ëª…": "ìë™ì°¨ì •ë¹„ê¸°ëŠ¥ì‚¬", "ì·¨ë“ì ìˆ˜": 15},
	{"ì§€ì—­": "ê²½ê¸°", "í•™êµ": "Cê³ ", "ìê²©ì¦ëª…": "ìš´ì „ë©´í—ˆ(2ì¢…)", "ì·¨ë“ì ìˆ˜": 7},
	{"ì§€ì—­": "ê²½ê¸°", "í•™êµ": "Dê³ ", "ìê²©ì¦ëª…": "ì§€ê²Œì°¨ìš´ì „ê¸°ëŠ¥ì‚¬", "ì·¨ë“ì ìˆ˜": 5},
	{"ì§€ì—­": "ë¶€ì‚°", "í•™êµ": "Eê³ ", "ìê²©ì¦ëª…": "ìë™ì°¨ì •ë¹„ê¸°ëŠ¥ì‚¬", "ì·¨ë“ì ìˆ˜": 9},
	{"ì§€ì—­": "ë¶€ì‚°", "í•™êµ": "Eê³ ", "ìê²©ì¦ëª…": "êµ´ì‚­ê¸°ìš´ì „ê¸°ëŠ¥ì‚¬", "ì·¨ë“ì ìˆ˜": 4},
]
df = pd.DataFrame(data)

# ì§€ì—­ ì„ íƒ
regions = df["ì§€ì—­"].unique().tolist()
selected_region = st.selectbox("ì§€ì—­ ì„ íƒ", ["ì „ì²´"] + regions)

if selected_region != "ì „ì²´":
	df = df[df["ì§€ì—­"] == selected_region]

# í•™êµ ì„ íƒ
schools = df["í•™êµ"].unique().tolist()
selected_school = st.selectbox("í•™êµ ì„ íƒ", ["ì „ì²´"] + schools)

if selected_school != "ì „ì²´":
	df = df[df["í•™êµ"] == selected_school]

st.header("ìê²©ì¦ë³„ ì·¨ë“ì ìˆ˜ (í•™êµë³„)")
chart1 = alt.Chart(df).mark_bar().encode(
	x=alt.X("ìê²©ì¦ëª…", sort="-y"),
	y="ì·¨ë“ì ìˆ˜",
	color="ìê²©ì¦ëª…",
	column="í•™êµ"
)
st.altair_chart(chart1, use_container_width=True)

st.header("ì§€ì—­ë³„ ìê²©ì¦ ì·¨ë“ì ìˆ˜ ì§‘ê³„")
region_count = df.groupby(["ì§€ì—­", "ìê²©ì¦ëª…"]).sum(numeric_only=True).reset_index()
chart2 = alt.Chart(region_count).mark_bar().encode(
	x=alt.X("ìê²©ì¦ëª…", sort="-y"),
	y="ì·¨ë“ì ìˆ˜",
	color="ì§€ì—­",
	column="ì§€ì—­"
)
st.altair_chart(chart2, use_container_width=True)

st.header("ë°ì´í„° í…Œì´ë¸”")
st.dataframe(df, use_container_width=True)
